<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:PlugHub.ViewModels.Pages"
             xmlns:b="using:PlugHub.Behaviors"
             xmlns:ui="clr-namespace:Avalonia.Themes.ui;assembly=Avalonia.Themes.ui"
             xmlns:fa="clr-namespace:FluentAvalonia.UI.Controls;assembly=FluentAvalonia"
             xmlns:c="clr-namespace:PlugHub.Converters"
             
             mc:Ignorable="d" d:DesignWidth="1230" d:DesignHeight="720"
             
             x:Class="PlugHub.Views.SettingsPluginsView"
             x:DataType="vm:SettingsPluginsViewModel"
             
             KeyDown="UserControl_KeyDown">

  <UserControl.Styles>

    <Style Selector="AutoCompleteBox.ClearButtonBox Button:disabled Path">
      <Setter Property="Stroke" Value="{DynamicResource PluginFilterEnabledBrush}" />
      <Setter Property="Fill" Value="Transparent" />
    </Style>
    <Style Selector="AutoCompleteBox.ClearButtonBox Button">
      <Setter Property="Template">
        <ControlTemplate>
          <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
            <ContentPresenter
              HorizontalAlignment="Center"
              VerticalAlignment="Center"
              Content="{TemplateBinding Content}" />
          </Grid>
        </ControlTemplate>
      </Setter>
    </Style>
    <Style Selector="AutoCompleteBox.DesciptorSearch">
      <Setter Property="InnerRightContent">
        <Template>
          <Button Width="16"
                  Height="16"
                  HorizontalAlignment="Right"
                  VerticalAlignment="Center"
                  Margin="0,0,8,0"
                  Padding="0"
                  Background="Transparent"
                  BorderBrush="Transparent"
                  IsTabStop="False">

            <PathIcon Data="{StaticResource sidebar_search_ltr_regular}" Width="16" Height="16"/>
          </Button>
        </Template>
      </Setter>
    </Style>

    <Style Selector="Expander">
      <Setter Property="Template">
        <ControlTemplate TargetType="Expander">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="96"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <ToggleButton IsChecked="{Binding IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                          BorderThickness="0"
                          Padding="0"
                          HorizontalAlignment="Stretch">

              <ToggleButton.Template>
                <ControlTemplate TargetType="ToggleButton">
                  <ContentPresenter Content="{TemplateBinding Content}" HorizontalAlignment="Stretch" VerticalAlignment="Center"/>
                </ControlTemplate>
              </ToggleButton.Template>

              <ContentPresenter Content="{TemplateBinding Header}" HorizontalAlignment="Stretch" />

            </ToggleButton>

            <ContentPresenter Grid.Row="1"
                              Content="{TemplateBinding Content}"
                              IsVisible="{TemplateBinding IsExpanded}"
                              Margin="96,0,64,0"/>
          </Grid>
        </ControlTemplate>
      </Setter>
    </Style>
    <Style Selector="Expander ToggleButton:checked">
      <Setter Property="Background" Value="{DynamicResource AccentFillColorDefaultBrush}" />
    </Style>
    <Style Selector="Expander .hover-bar" x:SetterTargetType="Border">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Height" Value="0"/>
      <Setter Property="Transitions">
        <Transitions>
          <DoubleTransition Property="Height" Duration="0:0:0.1"/>
        </Transitions>
      </Setter>
    </Style>
    <Style Selector="Expander:pointerover .hover-bar" x:SetterTargetType="Border">
      <Setter Property="Background" Value="{DynamicResource AccentFillColorDefaultBrush}"/>
      <Setter Property="Height" Value="32"/>
    </Style>

    <Style Selector="Border.interface-row">
      <Setter Property="Background" Value="Transparent"/>
    </Style>
    <Style Selector="Border.interface-row:pointerover">
      <Setter Property="Background" Value="{DynamicResource ControlAltFillColorTertiaryBrush}"/>
    </Style>

    <Style Selector="HeaderedContentControl.GroupBox">
      <Setter Property="Template">
        <ControlTemplate>
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Header -->
            <Border
                ZIndex="1"
                Background="{DynamicResource SolidBackgroundFillColorSecondaryBrush}"
                Padding="8,0,8,0"
                Margin="8,0,0,0">
              <TextBlock
                  Text="{TemplateBinding Header}"
                  FontWeight="Bold"/>
            </Border>

            <!-- Content Area -->
            <Border
                Grid.RowSpan="2"
                Padding="0,8,0,0"
                Grid.ColumnSpan="2"
                CornerRadius="4"
                Margin="0,8,0,0"
                BorderBrush="{DynamicResource ControlStrongFillColorDefaultBrush}"
                BorderThickness="1">
              <ContentPresenter
                  Name="PART_ContentPresenter"
                  Padding="8"
                  Content="{TemplateBinding Content}"/>
            </Border>
          </Grid>
        </ControlTemplate>
      </Setter>
    </Style>

    <Style Selector="Border.OverlayPanel:not(:slid-in)">
      <Setter Property="RenderTransform">
        <TranslateTransform X="400" />
      </Setter>
      <!--<Setter Property="IsHitTestVisible" Value="False"/>-->
    </Style>
    <Style Selector="Border.OverlayPanel:slid-in">
      <Setter Property="RenderTransform">
        <TranslateTransform X="0" />
      </Setter>
      <!--<Setter Property="IsHitTestVisible" Value="True"/>-->
      <Setter Property="Transitions">
        <Transitions>
          <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.3" />
        </Transitions>
      </Setter>
    </Style>

    <Style Selector="Button.NoPointerOver:pointerover /template/ ContentPresenter">
      <Setter Property="Background" Value="Transparent"/>
    </Style>

    <Style Selector="Button.DescriptorDetailsClose:pointerover /template/ ContentPresenter#PART_ContentPresenter">
      <Setter Property="Background" Value="Red"/>
    </Style>

  </UserControl.Styles>

  <UserControl.Resources>
    <c:UriToBitmapConverter x:Key="UriToBitmapConverter"/>
    <c:NullToBoolConverter x:Key="NullToBoolConverter"/>
    <c:BooleanNegationConverter x:Key="BooleanNegationConverter"/>
  </UserControl.Resources>

  <Grid>

    <Grid.RowDefinitions>
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="240"/>
      <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>

    <!-- Left Column -->
    <ScrollViewer Grid.Row="0" Grid.Column="0" VerticalAlignment="Stretch" Margin="8 8 16 8">
      <Border>
        <StackPanel>

          <!-- Plugin Search Box -->
          <AutoCompleteBox Classes="ClearButtonBox"
                           Watermark="Search plugins..."
                           Text="{Binding PluginSearchText}"
                           Margin="8,0,8,10">
            <AutoCompleteBox.Styles>
              <Style Selector="AutoCompleteBox">
                <Setter Property="InnerRightContent">
                  <Template>
                    <Button Width="24"
                            Height="24"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Margin="0,0,0,0"
                            Padding="0"
                            Background="Transparent"
                            BorderBrush="Transparent"
                            BorderThickness="0"
                            IsTabStop="False"
                            Click="OnPluginClearButtonClicked"
                            IsEnabled="{Binding DataContext.HasSearchOrCategorySelected, RelativeSource={RelativeSource AncestorType=UserControl}}">
                      <Path Data="M8,0A8,8,0,1,1,0,8A8,8,0,0,1,8,0ZM4,4L12,12M12,4L4,12"
                            Fill="Transparent"
                            Stroke="{DynamicResource PluginFilterDisabledBrush}"
                            StrokeThickness="1.5"/>
                    </Button>
                  </Template>
                </Setter>
              </Style>
            </AutoCompleteBox.Styles>
          </AutoCompleteBox>

          <!-- Plugin Categoriy Header -->
          <Border BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
                  BorderThickness="0,0,0,2"
                  Margin="8,0,0,0">

            <TextBlock Text="Categories"
                       FontWeight="Bold"
                       Margin="8"
                       FontSize="16"/>
          </Border>

          <!-- Plugin Category List -->
          <ListBox x:Name="PluginSettingsCategoryListBox"
                   ItemsSource="{Binding AvailableCategories}"
                   SelectionChanged="OnPluginCategorySelectionChanged"
                   SelectionMode="Multiple,Toggle">
            <ListBox.ItemTemplate>
              <DataTemplate>
                <TextBlock Text="{Binding}" Margin="16,8,8,8"/>
              </DataTemplate>
            </ListBox.ItemTemplate>
            <ListBox.Styles>
              <Style Selector="ListBoxItem">
                <Setter Property="Margin" Value="0"/>
                <Setter Property="Padding" Value="0"/>
              </Style>
            </ListBox.Styles>

          </ListBox>

        </StackPanel>
      </Border>
    </ScrollViewer>

    <!-- Main Content Column -->
    <!-- Plugin List -->
    <ListBox Grid.Row="0" Grid.Column="1"
             ItemsSource="{Binding FilteredPlugins}"
             SelectionChanged="ListBox_SelectionChanged"
             ScrollViewer.AllowAutoHide="False">

      <ListBox.Styles>
        <Style Selector="ListBoxItem">
          <Setter Property="Template">
            <ControlTemplate TargetType="ListBoxItem">
              <ContentPresenter Name="contentPresenter"
                                ContentTemplate="{TemplateBinding ContentTemplate}"
                                Content="{TemplateBinding Content}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
            </ControlTemplate>
          </Setter>
        </Style>
      </ListBox.Styles>

      <ListBox.ItemTemplate>
        <DataTemplate>
          <Border BorderThickness="1"
                  CornerRadius="4"
                  BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
                  Margin="0,0,16,0"
                  Padding="0,0,0,8"
                  Background="Transparent">
            <Expander>
              <Expander.Header>
                <Grid Background="Transparent">

                  <Grid.RowDefinitions>
                    <RowDefinition Height="24"/>
                    <RowDefinition Height="32"/>
                    <RowDefinition Height="40"/>
                  </Grid.RowDefinitions>

                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="4"/>
                    <ColumnDefinition Width="Auto" MinWidth="96"/>
                    <ColumnDefinition Width="*" MinWidth="300"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                  </Grid.ColumnDefinitions>

                  <!-- Hover bar -->
                  <Border Grid.Row="0" Grid.Column="0" Grid.RowSpan="3"
                          Classes="hover-bar"
                          Width="4"
                          HorizontalAlignment="Left"
                          VerticalAlignment="Center"
                          Margin="0,0,0,0"
                          CornerRadius="10">
                  </Border>

                  <!-- Plugin Icon -->
                  <Border Grid.RowSpan="3" Grid.Column="1"
                          Width="96" Height="96" Padding="8"
                          IsHitTestVisible="False">
                    <Grid>
                      <Image Source="{Binding IconSource, Converter={StaticResource UriToBitmapConverter}}"
                             Width="48" Height="48"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"
                             Stretch="UniformToFill"
                             IsVisible="{Binding HasImageIcon}"/>
                      <PathIcon Data="{StaticResource default_plugin}"
                                Width="48" Height="48"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                IsVisible="{Binding ShowDefaultIcon}"/>
                    </Grid>
                  </Border>

                  <!-- Plugin Name -->
                  <TextBlock Grid.Column="2" Grid.Row="0"
                             Padding="0" Margin="8,8,0,0"
                             FontSize="16" FontWeight="Bold"
                             IsHitTestVisible="False"
                             Text="{Binding Name}"/>

                  <!-- Plugin Version -->
                  <TextBlock Grid.Column="3" Grid.Row="0"
                             Padding="0" Margin="0,8,8,0"
                             FontSize="16" FontWeight="Bold"
                             IsHitTestVisible="False"
                             Text="{Binding Version, StringFormat='Version {0}'}"
                             HorizontalAlignment="Right"/>

                  <!-- Plugin Description -->
                  <Border Grid.Column="2" Grid.Row="1" BorderThickness="0" Padding="0" Margin="0">
                    <TextBlock Padding="0" Margin="8,0,0,0" FontSize="12"
                               TextWrapping="Wrap" IsHitTestVisible="False"
                               Text="{Binding Description}" MaxHeight="32"
                               TextTrimming="CharacterEllipsis"
                                Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                  </Border>

                  <!-- Plugin Author -->
                  <TextBlock Grid.Column="3" Grid.Row="1"
                             Padding="0" Margin="0,0,8,0"
                             FontSize="12" TextWrapping="Wrap"
                             IsHitTestVisible="False"
                             Text="{Binding Author}"
                             HorizontalAlignment="Right"
                             Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>

                  <!-- Plugin Links -->
                  <Border Grid.Column="2" Grid.Row="2" BorderThickness="0" Padding="0" Margin="0">
                    <StackPanel Orientation="Horizontal" Margin="8,0,0,0">
                      <Button Background="Transparent" BorderThickness="0" Padding="0"
                              Command="{Binding OpenDocumentationCommand}"
                              IsVisible="{Binding HasDocsLink}">
                        <StackPanel Orientation="Horizontal">
                          <PathIcon Data="{StaticResource book_question_mark_regular}" Width="16" Height="16"/>
                          <TextBlock Text="Documentation" VerticalAlignment="Center" Margin="8,0,0,0" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                      </Button>
                      <Button Background="Transparent" BorderThickness="0" Padding="0" Margin="16,0,0,0"
                              Command="{Binding OpenSupportCommand}" IsVisible="{Binding HasSupportLink}">
                        <StackPanel Orientation="Horizontal">
                          <PathIcon Data="{StaticResource question_circle_regular}" Width="16" Height="16"/>
                          <TextBlock Text="Support" VerticalAlignment="Center" Margin="8,0,0,0" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                      </Button>
                      <Button Background="Transparent" BorderThickness="0" Padding="0" Margin="16,0,0,0"
                              Command="{Binding OpenContactCommand}" IsVisible="{Binding HasSupportContact}">
                        <StackPanel Orientation="Horizontal">
                          <PathIcon Data="{StaticResource mail_regular}" Width="16" Height="16"/>
                          <TextBlock Text="Contact" VerticalAlignment="Center" Margin="8,0,0,0" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                      </Button>
                      <Button Background="Transparent" BorderThickness="0" Padding="0" Margin="16,0,0,0"
                              Command="{Binding OpenChangeLogCommand}" IsVisible="{Binding HasChangeLog}">
                        <StackPanel Orientation="Horizontal">
                          <PathIcon Data="{StaticResource history_regular}" Width="16" Height="16"/>
                          <TextBlock Text="Change Log" VerticalAlignment="Center" Margin="8,0,0,0" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                      </Button>
                    </StackPanel>
                  </Border>

                  <!-- Enable/Disable Toggle -->
                  <CheckBox Grid.Column="4" Grid.RowSpan="3"
                            IsThreeState="True"
                            Margin="24,0,24,0" Padding="0"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center"
                            IsChecked="{Binding IsEnabled}"
                            IsEnabled="{Binding HasNoInterfaces, Converter={StaticResource BooleanNegationConverter}}"/>

                </Grid>
              </Expander.Header>

              <Expander.Content>
                <StackPanel Background="Transparent">

                  <!-- Assembly file (metadata row) -->
                  <Border BorderThickness="0,0,0,1" Padding="8">
                    <Grid>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                      </Grid.ColumnDefinitions>
                      <TextBlock Text="Linked Library:" FontWeight="Bold" Margin="0,0,8,0"/>
                      <TextBlock Text="{Binding AssemblyFile}" Grid.Column="1" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </Grid>
                  </Border>

                  <!-- Table (header + rows), visible only if interfaces exist -->
                  <StackPanel IsVisible="{Binding HasNoInterfaces, Converter={StaticResource BooleanNegationConverter}}">
                    <Border BorderThickness="1,0,1,1"
                            Padding="8"
                            Background="{DynamicResource ControlAltFillColorSecondaryBrush}">
                      <Grid>
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="3*"/>
                          <ColumnDefinition Width="0.5*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Interface" FontWeight="Bold" Grid.Column="0"/>
                        <TextBlock Text="Enabled" FontWeight="Bold" Grid.Column="1" HorizontalAlignment="Center"/>
                      </Grid>
                    </Border>

                    <ItemsControl ItemsSource="{Binding ProvidedDescriptors}">
                      <ItemsControl.ItemTemplate>
                        <DataTemplate>
                          <Border Classes="interface-row" BorderThickness="0,0,0,1" Padding="8" BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}">
                            <Grid>
                              <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="3*"/>
                                <ColumnDefinition Width="0.5*"/>
                              </Grid.ColumnDefinitions>
                              <Button Grid.Column="0"
                                      Classes="NoPointerOver"
                                      Background="Transparent"
                                      HorizontalAlignment="Stretch"
                                      VerticalAlignment="Stretch"
                                      HorizontalContentAlignment="Left"
                                      Padding="0"
                                      BorderThickness="0"
                                      Command="{Binding DataContext.OpenDescriptorInfoCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                      CommandParameter="{Binding}">
                                <TextBlock Text="{Binding Name}"
                                           VerticalAlignment="Center"
                                           Background="Transparent"
                                           Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                              </Button>

                              <ToggleSwitch IsChecked="{Binding IsEnabled, Mode=TwoWay}"
                                            IsEnabled="{Binding IsSystem, Converter={StaticResource BooleanNegationConverter}}"
                                            Grid.Column="1"
                                            HorizontalAlignment="Center"/>
                            </Grid>
                          </Border>
                        </DataTemplate>
                      </ItemsControl.ItemTemplate>
                    </ItemsControl>
                  </StackPanel>

                  <!-- No interfaces placeholder row -->
                  <Border Classes="interface-row"
                          BorderThickness="0,0,0,1"
                          Padding="8"
                          IsVisible="{Binding HasNoInterfaces}">

                    <TextBlock Text="No interfaces provided"
                               FontStyle="Italic"
                               HorizontalAlignment="Center"/>
                  </Border>

                </StackPanel>
              </Expander.Content>

            </Expander>
          </Border>
        </DataTemplate>
      </ListBox.ItemTemplate>

    </ListBox>

    <!-- The overlay panel -->
    <Border Grid.Row="0" Grid.Column="1"
            x:Name="InterfaceDetailPanel"
            Classes="OverlayPanel"
            Background="{DynamicResource SolidBackgroundFillColorSecondaryBrush}"
            IsVisible="{Binding IsPanelVisible}"
            HorizontalAlignment="Right"
            VerticalAlignment="Stretch"
            Padding="8"
            Margin="0,0,16,0"
            Width="400"
            CornerRadius="4"
            RenderTransformOrigin="0,0">

      <Border.RenderTransform>
        <TranslateTransform X="0" />
      </Border.RenderTransform>

      <Grid RowDefinitions="Auto, *, Auto">
        <StackPanel>

          <!-- Name and Hide Button at Top Right -->
          <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center" ColumnDefinitions="*,Auto" Margin="0,0,0,8">
            <TextBlock Text="{Binding SelectedInterface}"
                       VerticalAlignment="Center"
                       FontWeight="Bold"
                       Grid.Column="0"
                       TextTrimming="CharacterEllipsis"/>

            <Button Grid.Column="1"
                    HorizontalAlignment="Right"
                    Classes="DescriptorDetailsClose"
                    Width="24" Height="24"
                    ToolTip.Tip="Hide Details"
                    Command="{Binding CloseDescriptorInfoCommand}">
              <PathIcon
                Width="12" Height="12"
                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                Data="M0,0 L4,4 L0,8 L2,8 L6,4 L2,0 Z M6,0 L10,4 L6,8 L8,8 L12,4 L8,0 Z"/>
            </Button>
          </Grid>

          <!-- Interface Search -->
          <AutoCompleteBox Watermark="Filter plugins..."
                             Classes="DesciptorSearch"
                             Text="{Binding DescriptorSearchText, Mode=TwoWay}"
                             Grid.Column="0"
                             MinWidth="100"
                             HorizontalAlignment="Stretch"/>

        </StackPanel>

        <!-- Interface DataGrid -->
        <DataGrid Grid.Row="1"
                  Margin="0,8,0,0"
                  Name="TargetDataGrid"
                  ItemsSource="{Binding FilteredInterfaceDescriptorData}"
                  SelectedItem="{Binding SelectedDescriptor, Mode=TwoWay}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  GridLinesVisibility="All"
                  BorderThickness="1"
                  BorderBrush="Gray"
                  CornerRadius="4">

          <DataGrid.Columns>
            <DataGridTemplateColumn Header="Plugin" Width="4*">
              <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                  <TextBlock Text="{Binding PluginName, TargetNullValue=''}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="4,0,0,0"/>
                </DataTemplate>
              </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
            <DataGridTemplateColumn Header="State" Width="1*" SortMemberPath="SortOrder" CanUserSort="True">
              <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                  <TextBlock Text="{Binding State}" HorizontalAlignment="Center" VerticalAlignment="Center" ToolTip.Tip="{Binding Message}"/>
                </DataTemplate>
              </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
          </DataGrid.Columns>

        </DataGrid>

        <!-- Interface Details Panel -->
        <HeaderedContentControl Grid.Row="2"
                                Classes="GroupBox"
                                Header="Descriptor Details"
                                IsVisible="{Binding SelectedDescriptor, Converter={StaticResource NullToBoolConverter}}">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <TextBlock Text="Plugin Name:" FontWeight="SemiBold" Grid.Row="0" Grid.Column="0" Margin="0,0,16,8" VerticalAlignment="Center"/>
            <SelectableTextBlock Grid.Row="0" Grid.Column="1"
                                 Text="{Binding SelectedDescriptor.PluginName}"
                                 Margin="0,0,0,8" />

            <TextBlock Text="Plugin ID:" FontWeight="SemiBold" Grid.Row="1" Grid.Column="0" Margin="0,0,16,8" VerticalAlignment="Center"/>
            <SelectableTextBlock Grid.Row="1" Grid.Column="1"
                                 Text="{Binding SelectedDescriptor.Descriptor.PluginID}"
                                 FontSize="12"
                                 Margin="0,0,0,8" />

            <TextBlock Text="Descriptor ID:" FontWeight="SemiBold" Grid.Row="2" Grid.Column="0" Margin="0,0,16,8" VerticalAlignment="Center"/>
            <SelectableTextBlock Grid.Row="2" Grid.Column="1"
                                 Text="{Binding SelectedDescriptor.Descriptor.DescriptorID}"
                                 FontSize="12"
                                 Margin="0,0,0,8" />
          </Grid>
        </HeaderedContentControl>

      </Grid>
    </Border>

    <!-- Restart Banner -->
    <Grid Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="1">
      <fa:InfoBar IsVisible="{Binding ShowRestartBanner}"
                  Title="Restart Required"
                  IsOpen="True"
                  IsIconVisible="True"
                  IsClosable="False"
                  Severity="Warning"
                  Message="Please restart the application for plugin changes to take effect.">
        <fa:InfoBar.ActionButton>
          <Button Content="Revert" HorizontalAlignment="Right" Command="{Binding RevertPluginChangesCommand}"/>
        </fa:InfoBar.ActionButton>
      </fa:InfoBar>
    </Grid>

  </Grid>
</UserControl>